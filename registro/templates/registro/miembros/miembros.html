{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
{% block head %}
{% endblock %}
  <title>Miembros</title>
</head>

{% block content %}

<div class='m-4 flex flex-row justify-between'>
  <h3 class='mt-2 text-md font-semibold'>Total de miembros: {{ miembros.count }}</h3>
  {% if user.is_admin %}
    <a href='{% url 'agregar_miembro' %}'>
      <button class='add-button'>
        Agregar miembro
      </button>
    </a>
  {% endif %}
</div>

<div id='modal-place'></div>

<table class='custom-table'>
  <thead>
    <tr>
      <th style='width: 4%;'>ID</th>
      <th style='width: 40%'>Nombre</th>
      <th style='width: 12%;'>Horas trabajadas</th>
      <th style='width: 18%;'>Misiones</th>
      <th style='width: 18%'>Subsistemas</th>
      {% if user.is_admin %}
        <th style='width: 8%;'>Acciones</th>
      {% endif %}
    </tr>
  </thead>

  <tbody>
    {% for miembro in miembros %}
      <tr>
        <td>{{ miembro.pk }}</td>
        <td>
          {% if user.pk == miembro.pk or user.is_admin %}
            <a class='cursor-pointer'
            hx-get='{% url 'registros' miembro.pk %}'
            hx-target='#content'
            hx-push-url='true'>
          {% endif %}
            {{ miembro.nombre }}
          </a>
        </td>
        <td>0 / {{ miembro.horas_acordadas }}</td>
        <td>
          {% for mision in miembro.mision.all %}
            {{ mision.nombre }}{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </td>
        <td>
          {% for subsistema in miembro.subsistema.all %}
            {{ subsistema.nombre }}{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </td>

        {% if user.is_admin %}
          <td class='flex flex-row items-center justify-center'>
            <a class='mx-2 material-symbols-outlined' href='{% url 'editar_miembro' miembro.pk %}'>
              edit_square
            </a>
            <a class='mx-2 cursor-pointer material-symbols-outlined' 
             hx-get='{% url 'eliminar_miembro' miembro.pk %}'
             hx-target='#modal-place'>
              delete
            </a>
          </td>
        {% endif %}

      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
</html>

